{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/mac/I/InstaClone/src/client/Screens/Home/Home.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Component } from \"react\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Header } from \"react-native-web/dist/index\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { connect } from \"react-redux\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { COLORS, SIZES, FONTS } from \"../../constants\";\nimport axios from \"axios\";\nimport { Container, Content, Icon, Thumbnail } from \"native-base\";\nimport instalogo from \"../../assets/image/insta.png\";\nimport dm from \"../../assets/image/dm.png\";\nimport { displaylikes as _displaylikes } from \"../../actions/postsActions\";\nimport PostComponent from \"./PostComponent\";\nimport { isLogedIn } from \"../../actions/AuthActions\";\nimport { baseURL } from \"../../constants\";\n\nvar Home = function (_Component) {\n  _inherits(Home, _Component);\n\n  var _super = _createSuper(Home);\n\n  function Home(props) {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    _this = _super.call(this, props);\n    _this.list = [];\n\n    _this.getIdValue = function _callee() {\n      var value;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"Id\"));\n\n            case 2:\n              value = _context.sent;\n              _this.Id = value;\n              return _context.abrupt(\"return\", value);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.listUsers = function () {\n      axios({\n        method: \"post\",\n        url: \"/listUsers\",\n        baseURL: baseURL,\n        data: {\n          Id: _this.Id\n        }\n      }).then(function (res) {\n        _this.setState({\n          data: res.data.lista\n        });\n      }).catch(function (err) {\n        console.log(err.message);\n      });\n    };\n\n    _this.listPosts = function () {\n      axios({\n        method: \"post\",\n        url: \"/listPosts\",\n        baseURL: baseURL,\n        data: {\n          Id: _this.Id\n        }\n      }).then(function (res) {\n        _this.setState({\n          posts: res.data.totalPosts\n        });\n      }).catch(function (err) {\n        console.log(err.message);\n      });\n    };\n\n    _this.verifyConnexion = function () {\n      if (!isLogedIn()) {\n        _this.props.navigation.navigate(\"LogIn\");\n      }\n    };\n\n    _this.renderUsers = function (users) {\n      return users.map(function (user, index) {\n        var followRequest = function followRequest() {\n          axios({\n            method: \"post\",\n            url: \"/follow\",\n            baseURL: baseURL,\n            data: {\n              Id: _this.Id,\n              followId: user.Id\n            }\n          }).then(function (res) {\n            _this.setState({\n              test: 1\n            });\n\n            _this.listUsers();\n\n            _this.listPosts();\n          }).catch(function (err) {\n            console.log(err.message);\n          });\n        };\n\n        var unfollowRequest = function unfollowRequest() {\n          axios({\n            method: \"post\",\n            url: \"/unfollow\",\n            baseURL: baseURL,\n            data: {\n              Id: _this.Id,\n              followId: user.Id\n            }\n          }).then(function (res) {\n            _this.setState({\n              test: 1\n            });\n\n            _this.listUsers();\n\n            _this.listPosts();\n          }).catch(function (err) {\n            console.log(err.message);\n          });\n        };\n\n        var onpress = user.follow ? unfollowRequest : followRequest;\n        var text = user.follow ? \"unfollow\" : \"follow\";\n        return React.createElement(View, {\n          style: {\n            alignItems: \"center\",\n            marginLeft: 10\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 9\n          }\n        }, React.createElement(Thumbnail, {\n          source: {\n            uri: user.url\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 11\n          }\n        }), React.createElement(Text, {\n          style: {\n            marginHorizontal: 5,\n            fontSize: 15\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 11\n          }\n        }, user.name), React.createElement(TouchableOpacity, {\n          style: {\n            height: 30,\n            width: 80,\n            backgroundColor: \"#048ba8\",\n            borderRadius: SIZES.radius / 0.2,\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          onPress: onpress,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 11\n          }\n        }, React.createElement(Text, {\n          style: _objectSpread({\n            color: COLORS.white\n          }, FONTS.h3),\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }\n        }, text)));\n      });\n    };\n\n    _this.renderPosts = function (posts) {\n      var sortedposts = posts.sort(function (a, b) {\n        return Date.parse(b.date) - Date.parse(a.date);\n      });\n      return sortedposts.map(function (post, index) {\n        var name = post.username;\n        var url = post.posts;\n        var userpicurl = post.picurl;\n        var date = post.date;\n        var caption = post.caption;\n        console.log(post);\n        return React.createElement(PostComponent, {\n          imageSource: url,\n          likes: post.likes.length,\n          username: name,\n          userpicurl: userpicurl,\n          date: date,\n          caption: caption,\n          Id: post.Id,\n          userid: _this.Id,\n          navigation: _this.props.navigation,\n          displaylikes: _this.props.displaylikes,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 9\n          }\n        });\n      });\n    };\n\n    _this.state = {\n      data: [],\n      posts: [],\n      Id: \"\",\n      test: 0\n    };\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              this.verifyConnexion();\n              this.willFocusSubscription = this.props.navigation.addListener(\"willFocus\", function () {\n                _this2.verifyConnexion();\n              });\n              _context2.next = 4;\n              return _regeneratorRuntime.awrap(this.getIdValue());\n\n            case 4:\n              this.listUsers();\n              this.listPosts();\n              this.render();\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.willFocusSubscription.remove();\n    }\n  }, {\n    key: \"parseDate\",\n    value: function parseDate(input) {\n      var parts = input.match(/(\\d+)/g);\n      return new Date(parts[0], parts[1] - 1, parts[2]);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(View, {\n        style: {\n          flex: 1,\n          height: 200,\n          backgroundColor: COLORS.primary\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 7\n        }\n      }, React.createElement(Image, {\n        source: instalogo,\n        style: {\n          width: 120,\n          height: 35,\n          marginLeft: 20,\n          tintColor: \"black\",\n          marginTop: 35,\n          marginBottom: 10\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 9\n        }\n      }), React.createElement(Image, {\n        source: dm,\n        style: {\n          width: 25,\n          height: 25,\n          marginRight: 20,\n          alignSelf: \"flex-end\",\n          tintColor: \"black\",\n          marginTop: -40\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 9\n        }\n      }), React.createElement(Container, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 9\n        }\n      }, React.createElement(Content, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: {\n          height: 115,\n          backgroundColor: COLORS.primary\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          flex: 3\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 15\n        }\n      }, React.createElement(ScrollView, {\n        horizontal: true,\n        showsHorizontalScrollIndicator: false,\n        contentContainerStyle: {\n          alignItems: \"center\",\n          paddingStart: 5,\n          paddingEnd: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 17\n        }\n      }, this.renderUsers(this.state.data)))), React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 13\n        }\n      }, this.renderPosts(this.state.posts)))));\n    }\n  }]);\n\n  return Home;\n}(Component);\n\nHome.navigationOptions = {\n  tabBarIcon: function tabBarIcon(_ref) {\n    var tintColor = _ref.tintColor;\n    return React.createElement(Icon, {\n      name: \"ios-home\",\n      style: {\n        color: tintColor\n      },\n      __self: Home,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 7\n      }\n    });\n  }\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"white\",\n    marginTop: 15\n  }\n});\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    displaylikes: function displaylikes(data) {\n      return dispatch(_displaylikes(data));\n    }\n  };\n};\n\nexport default connect(mapStatetoProps, mapDispatchToProps)(Home);","map":{"version":3,"sources":["/Users/mac/I/InstaClone/src/client/Screens/Home/Home.js"],"names":["Component","AsyncStorage","React","useState","useRef","useEffect","Header","connect","LinearGradient","COLORS","SIZES","FONTS","axios","Container","Content","Icon","Thumbnail","instalogo","dm","displaylikes","PostComponent","isLogedIn","baseURL","Home","props","list","getIdValue","getItem","value","Id","listUsers","method","url","data","then","res","setState","lista","catch","err","console","log","message","listPosts","posts","totalPosts","verifyConnexion","navigation","navigate","renderUsers","users","map","user","index","followRequest","followId","test","unfollowRequest","onpress","follow","text","alignItems","marginLeft","uri","marginHorizontal","fontSize","name","height","width","backgroundColor","borderRadius","radius","justifyContent","color","white","h3","renderPosts","sortedposts","sort","a","b","Date","parse","date","post","username","userpicurl","picurl","caption","likes","length","state","willFocusSubscription","addListener","render","remove","input","parts","match","flex","primary","tintColor","marginTop","marginBottom","marginRight","alignSelf","styles","container","paddingStart","paddingEnd","navigationOptions","tabBarIcon","StyleSheet","create","mapDispatchToProps","dispatch","mapStatetoProps"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport {\n  View,\n  Button,\n  TextInput,\n  Text,\n  Alert,\n  StyleSheet,\n  Header,\n  Image,\n  ScrollView,\n  TouchableOpacity,\n} from \"react-native\";\nimport { connect } from \"react-redux\";\nimport { LinearGradient } from \"expo-linear-gradient\";\n\nimport { COLORS, SIZES, FONTS } from \"../../constants\";\n\nimport axios from \"axios\";\n\nimport { Container, Content, Icon, Thumbnail } from \"native-base\";\n\nimport instalogo from \"../../assets/image/insta.png\";\n\nimport dm from \"../../assets/image/dm.png\";\nimport { displaylikes } from \"../../actions/postsActions\";\n\nimport PostComponent from \"./PostComponent\";\n\nimport { isLogedIn } from \"../../actions/AuthActions\";\n\nimport { baseURL } from \"../../constants\";\n\nclass Home extends Component {\n  list = [];\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      data: [],\n      posts: [],\n      Id: \"\",\n      test: 0,\n    };\n  }\n\n  getIdValue = async () => {\n    var value = await AsyncStorage.getItem(\"Id\");\n    this.Id = value;\n    return value;\n  };\n\n  listUsers = () => {\n    axios({\n      method: \"post\",\n      url: \"/listUsers\",\n      baseURL: baseURL,\n      data: {\n        Id: this.Id,\n      },\n    })\n      .then((res) => {\n        this.setState({ data: res.data.lista });\n      })\n\n      .catch((err) => {\n        console.log(err.message);\n      });\n  };\n\n  listPosts = () => {\n    axios({\n      method: \"post\",\n      url: \"/listPosts\",\n\n      baseURL: baseURL,\n      data: {\n        Id: this.Id,\n      },\n    })\n      .then((res) => {\n        this.setState({ posts: res.data.totalPosts });\n      })\n\n      .catch((err) => {\n        console.log(err.message);\n      });\n  };\n\n  verifyConnexion = () => {\n    if (!isLogedIn()) {\n      this.props.navigation.navigate(\"LogIn\");\n    }\n  };\n\n  async componentDidMount() {\n    this.verifyConnexion();\n    this.willFocusSubscription = this.props.navigation.addListener(\n      \"willFocus\",\n      () => {\n        this.verifyConnexion();\n      }\n    );\n    await this.getIdValue();\n    this.listUsers();\n    this.listPosts();\n    this.render();\n  }\n\n  componentWillUnmount() {\n    this.willFocusSubscription.remove();\n  }\n\n  static navigationOptions = {\n    tabBarIcon: ({ tintColor }) => (\n      <Icon name=\"ios-home\" style={{ color: tintColor }} />\n    ),\n  };\n\n  renderUsers = (users) => {\n    return users.map((user, index) => {\n      let followRequest = () => {\n        axios({\n          method: \"post\",\n          url: \"/follow\",\n          baseURL: baseURL,\n          data: {\n            Id: this.Id,\n\n            followId: user.Id,\n          },\n        })\n          .then((res) => {\n            this.setState({ test: 1 });\n            this.listUsers();\n            this.listPosts();\n          })\n\n          .catch((err) => {\n            console.log(err.message);\n          });\n      };\n\n      let unfollowRequest = () => {\n        axios({\n          method: \"post\",\n          url: \"/unfollow\",\n          baseURL: baseURL,\n          data: {\n            Id: this.Id,\n            followId: user.Id,\n          },\n        })\n          .then((res) => {\n            this.setState({ test: 1 });\n            this.listUsers();\n            this.listPosts();\n          })\n          .catch((err) => {\n            console.log(err.message);\n          });\n      };\n\n      let onpress = user.follow ? unfollowRequest : followRequest;\n      let text = user.follow ? \"unfollow\" : \"follow\";\n      return (\n        <View style={{ alignItems: \"center\", marginLeft: 10 }}>\n          <Thumbnail\n            source={{\n              uri: user.url,\n            }}\n          />\n          <Text\n            style={{\n              marginHorizontal: 5,\n              fontSize: 15,\n            }}\n          >\n            {user.name}\n          </Text>\n          <TouchableOpacity\n            style={{\n              height: 30,\n              width: 80,\n              backgroundColor: \"#048ba8\",\n              borderRadius: SIZES.radius / 0.2,\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}\n            onPress={onpress}\n          >\n            <Text style={{ color: COLORS.white, ...FONTS.h3 }}>{text}</Text>\n          </TouchableOpacity>\n        </View>\n      );\n    });\n  };\n  parseDate(input) {\n    var parts = input.match(/(\\d+)/g);\n    // new Date(year, month [, date [, hours[, minutes[, seconds[, ms]]]]])\n    return new Date(parts[0], parts[1] - 1, parts[2]); // months are 0-based\n  }\n\n  renderPosts = (posts) => {\n    const sortedposts = posts.sort(\n      (a, b) => Date.parse(b.date) - Date.parse(a.date)\n    );\n\n    return sortedposts.map((post, index) => {\n      var name = post.username;\n      var url = post.posts;\n      var userpicurl = post.picurl;\n      var date = post.date;\n      var caption = post.caption;\n      console.log(post);\n      return (\n        <PostComponent\n          imageSource={url}\n          likes={post.likes.length}\n          username={name}\n          userpicurl={userpicurl}\n          date={date}\n          caption={caption}\n          Id={post.Id}\n          userid={this.Id}\n          navigation={this.props.navigation}\n          displaylikes={this.props.displaylikes}\n        />\n      );\n    });\n  };\n\n  render() {\n    return (\n      <View style={{ flex: 1, height: 200, backgroundColor: COLORS.primary }}>\n        <Image\n          source={instalogo}\n          style={{\n            width: 120,\n            height: 35,\n            marginLeft: 20,\n            tintColor: \"black\",\n            marginTop: 35,\n            marginBottom: 10,\n          }}\n        ></Image>\n        <Image\n          source={dm}\n          style={{\n            width: 25,\n            height: 25,\n            marginRight: 20,\n            alignSelf: \"flex-end\",\n            tintColor: \"black\",\n            marginTop: -40,\n          }}\n        ></Image>\n\n        <Container style={styles.container}>\n          <Content>\n            <View style={{ height: 115, backgroundColor: COLORS.primary }}>\n              <View style={{ flex: 3 }}>\n                <ScrollView\n                  horizontal={true}\n                  showsHorizontalScrollIndicator={false}\n                  contentContainerStyle={{\n                    alignItems: \"center\",\n                    paddingStart: 5,\n                    paddingEnd: 5,\n                  }}\n                >\n                  {this.renderUsers(this.state.data)}\n                </ScrollView>\n              </View>\n            </View>\n\n            <View>{this.renderPosts(this.state.posts)}</View>\n          </Content>\n        </Container>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"white\",\n    marginTop: 15,\n  },\n});\n\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n  \n    displaylikes: (data) => dispatch(displaylikes(data)),\n  };\n};\n\nexport default connect(mapStatetoProps, mapDispatchToProps)(Home);\n\n"]},"metadata":{},"sourceType":"module"}